{% extends 'base.html' %} 

{% block title %}Lista de Viagens{% endblock %}

{% block content %}
    <h1 class="mb-4">Pacotes de Viagem</h1>

    {% if user.is_authenticated %}
        <div class="alert alert-info d-flex align-items-center mb-4" role="alert">
            <i class="bi bi-rocket-takeoff-fill me-2 fs-4"></i> 
            
            <p class="mb-0">
                Olá, **{{ user.username|capfirst }}**! Você está pronto para gerenciar as melhores ofertas de viagem.
                <small class="ms-3">(<a href="{% url 'logout' %}" class="alert-link">Sair</a>)</small>
            </p>
        </div>
        
        <a href="{% url 'viagem_nova' %}" class="btn btn-success mb-3">
            <i class="bi bi-plus-circle-fill"></i> Novo Pacote
        </a>

    {% else %}
        <div class="alert alert-warning mb-4" role="alert">
            Você está visualizando a lista de pacotes. Faça o <a href="{% url 'login' %}" class="alert-link">login</a> para **gerenciar (adicionar/editar/excluir)** os pacotes.
        </div>
        
        <button class="btn btn-success mb-3" disabled title="Faça login para adicionar pacotes">
            <i class="bi bi-plus-circle-fill"></i> Novo Pacote
        </button>
    {% endif %}

    {% if viagens %}
    <div class="table-responsive">
        <table class="table table-striped table-hover align-middle">
            <thead class="table-dark">
                <tr>
                    <th>Código</th>
                    <th>Destino</th>
                    <th>Partida</th>
                    <th>Duração</th>
                    <th>Preço Base</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for viagem in viagens %}
                <tr>
                    <td>{{ viagem.codigo_pacote }}</td>
                    <td><a href="{% url 'viagem_detalhe' viagem.pk %}">{{ viagem.destino }}</a></td>
                    <td>{{ viagem.data_partida|date:"d/m/Y" }}</td>
                    <td>{{ viagem.duracao_dias }} dias</td>
                    <td>R$ {{ viagem.preco_base|floatformat:2 }}</td>
                    
                    <td>
                        <a href="{% url 'viagem_detalhe' viagem.pk %}" class="btn btn-sm btn-info text-white me-1">Ver</a>
                        
                        {% if user.is_authenticated %}
                            <a href="{% url 'viagem_editar' viagem.pk %}" class="btn btn-sm btn-warning me-1">Editar</a>
                            <a href="{% url 'viagem_excluir' viagem.pk %}" class="btn btn-sm btn-danger">Excluir</a>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% else %}
    <div class="alert alert-info" role="alert">
        Nenhuma viagem cadastrada. Clique no botão acima para adicionar um novo pacote!
    </div>
    {% endif %}
    
{% endblock %}